\chapter{Метод стахостической оптимизации при решении обратной задачи
  теории Ми} \label{chapt2}

\section{Современные методы теоретического исследования новых оптических
  свойств наночастиц}
\label{sec:construct-review}

Развитие нанофотоники, как и многих других разделов физики, происходит
при одновременном развитии теории и эксперимента, которые оказываются
тесно связаны между собой.  Эксперимент служит мерилом правильности
теоретических построений и, в то же время, является источником
разнообразных физических эффектов. В этом случае, определяющей
становится роль теоретического анализа, необходимого для выделения
сути явления из вороха возможных побочных факторов.  Аналогично, при
исследовании оптических свойств наночастиц можно либо брать результаты
эксперимента и проверять, насколько они соотносятся с существующими
моделями, либо вначале теоретически находить дизайны с новыми физическими
свойствами, а уже потом проверять их экспериментально.  Учитывая
высокую стоимость и трудоёмкость подобного эксперимента второй вариант
оказывается более привлекательным.

Теоретическое исследование новых оптических свойств может быть
полностью аналитическим. Например, в работе Григорьева и
др.~\cite{Grigoriev-2015} рассматривается эффект идеального поглощения
на примере двухслойной частицы, в частности, случай диэлектрической
сферы во вмещающей среде, покрытой слоем золота или серебра. Используя
дипольное приближение они получили выражение для эффективного значения
диэлектрической проницаемости, обеспечивающего максимально достижимое
значение поглощения для сферы заданного размера.  Применяя теорию
эффективной среды Максвелла-Гарнета они также получили выражение для
объёмной доли диэлектрика, при которой возникает эффект идеального
поглощения в рассматриваемых двухслойных частицах.  Указанный подход
обладает рядом недостатков, среди которых можно отметить ограниченную
применимость (вследствие использования дипольного приближения можно
рассматривать только относительно небольшие частицы), и то,
что для большинства значений параметра размера объёмная доля
выражается комплексным числом.  Последний факт делает эту теорию
малопригодной для экспериментальной верификации. 

Среди других примеров полностью аналитического рассмотрения стоит
отметить работы Zh.~Ruan и  Sh.~Fan~\cite{Fan-2011,Fan-2010}








\underline{\textbf{Вторая глава}} посвящена выбору универсального
алгоритма оптимизации и вопросам его практической
реализации. Сложность выбора обусловлена огромным количеством методов
оптимизации, а также большим числом разновидностей каждого
метода. При выборе метода применительно к задаче Ми были использованны
следующие предпосылки:
\begin{itemize}
\item Несмотря на то, что решение Ми является аналитическим и
  выражается в виде разложения в ряд по сферическим векторным
  гармоникам, одновременное нахождение производных для зависимости от
  радиуса и материального параметра оказывается громоздким даже в
  случае однородной сферы, что тем более верно для случая
  произвольного числа сферических слоёв.  В связи с чем метод
  оптимизации не должен требовать для своей работы нахождения значений
  производных оптимизируемой функции.  Это особено актуально в случае,
  когда одновременно оптимизируются и толщина, и показатель
  преломления каждого слоя, или, например, оптимизируемая величина
  берётся в нескольких точках спектра одновременно.  Более того, могут
  возникать задачи, когда требуется оптимизировать значение поля внутри
  или рядом с конструируемой частицей.
\item Решение образовано быстро-осциллирующими функциями и, как
  следствие, будет содержать большое количество локальных
  экстремумов. Таким образом, алгоритмы оптимизации, требующие особого
  отношения к подобным случаям, оказываются заведомо менее
  производительными.
\item Параметры оптимизации (толщина и показатель
  преломления каждого слоя), а так же оптимизируемая величина
  (например эффективность рассеяния) являются
  вещественными числами.
\end{itemize}

Всё вместе это приводит к необходимости исключить из рассмотрения
такие популярные методы, как метод наискорейшего спуска (требующий
вычисления градиента), симплекс-метод Нелдера--Мида (есть сложность с
локальными экстремумами) и аналогичные им. В результате приходится
ограничить выбор стохастическими методами, среди которых наиболее
распространёнными являются генетические алгоритмы, методы роя частиц и
методы дифференциальной эволюции.  Все эти алгоритмы используют метод
<<проб и ошибок>>.  Несколько пробных решений (называемых индивидами)
генерируются случайным образом и многократно улучшаются в надежде
найти некое удовлетворительное решение. Качество решения оценивается
целевой функцией, формулируемой в задаче, которую предстоит
оптимизировать.  Полная группа индивидов называется популяцией.
Состояние популяции на конкретном шаге итерации называется поколением.
Переход между поколениями осуществляется в соответствии с рядом
относительно простых правил, которые составляют сущность определённого
алгоритма.

Генетические алгоритмы обычно рассматривают вещественные числа в виде
набора битов.  В отличие от них, методы роя частиц и методы
дифференциальной эволюции могут работать в непрерывном пространстве
вещественных входных параметров естественным образом (используя
возможность сложения и вычитания векторов пробных решений), что делает
их гораздо более удобными для решения физических и инженерных
задач.  Производительность этих алгоритмов зависит от правильного
выбора значений некоторых внутренних параметров
алгоритма.  Использование адаптивных версий алгоритмов упрощает задачу
оптимизации: их значения внутренних параметров настраиваются
автоматически при переходе между поколениями. Как правило, адаптивным
алгоритмам нужно гораздо меньше (более чем на порядок) итераций, чем
неадаптивным, чтобы добиться того же результата оптимизации.

В настоящей работе был реализован алгоритм JADE+ с улучшенной
скоростью скрещивания (по алгоритму PMCRADE), который является
адаптивным вариантом алгоритма дифференциальной эволюции. Он имеет
явное преимущество перед адаптивной оптимизацией методом роя частиц в
ряде стандартных тестов.  Выполненная в рамках настоящей работы
реализация указанного метода позволяет эффективно использовать
современные процессоры с большим количеством параллельных потоков
вычисления и может выполняться на суперкомпьютерных кластерах, что
стало возможно благодаря использованию программных библиотек,
поддерживающих стандарт Message Parsing Interface (MPI).
Разработанное~\cite{JADE-web} программное обеспечение успешно проходит
набор стандартных тестов~\cite{Schwefel-1981,Rosenbrock-1960,Muhlenbein-1991,back-1996,Griewank-1981} для алгоритмов оптимизации. 

\begingroup % Ограничиваем область видимости arraystretch
\renewcommand{\arraystretch}{1.6}%% Увеличение расстояния между рядами, для улучшения восприятия.
\begin{longtabu} to \textwidth {@{}>{\setlength{\baselineskip}{0.7\baselineskip}}X[1.1mc]>{\setlength{\baselineskip}{0.7\baselineskip}}X[mc]X[4]@{}}
        \caption{Тестовые функции для оптимизации, $D$ -
          размерность. Для всех функций значение в точке глобального
          минимума равно нулю.\label{tbl:test-functions}}\\% label всегда желательно идти после caption 
        
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endfirsthead

        \multicolumn{3}{c}{\small\slshape (продолжение)}        \\ 
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endhead
        
        \multicolumn{3}{c}{\small\slshape (окончание)}        \\ 
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endlasthead

        \bottomrule %%% нижняя линейка
        \multicolumn{3}{r}{\small\slshape продолжение следует}  \\ 
        \endfoot   
        \endlastfoot

        сфера         &$\left[-100,\,100\right]^D$   &
        $\begin{aligned}\textstyle f_1(x)=\sum_{i=1}^Dx_i^2\end{aligned}$                                                        \\
        Schwefel 2.22 &$\left[-10,\,10\right]^D$     &
        $\begin{aligned}\textstyle f_2(x)=\sum_{i=1}^D|x_i|+\prod_{i=1}^D|x_i|\end{aligned}$                                     \\
        Schwefel 1.2  &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_3(x)=\sum_{i=1}^D\left(\sum_{j=1}^ix_j\right)^2\end{aligned}$                               \\
        Schwefel 2.21 &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_4(x)={\rm max}_i\!\left\{\left|x_i\right|\right\}\end{aligned}$                             \\
        Rosenbrock    &$\left[-30,\,30\right]^D$     &$\begin{aligned}\textstyle f_5(x)=\sum_{i=1}^{D-1}\left[100\!\left(x_{i+1}-x_i^2\right)^2+(x_i-1)^2\right]\end{aligned}$ \\
        ступенчатая   &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_6(x)=\sum_{i=1}^D\big\lfloor x_i+0.5\big\rfloor^2\end{aligned}$                             \\ 
зашумлённая квартическая  &$\left[-1.28,\,1.28\right]^D$ &$\begin{aligned}\textstyle f_7(x)=\sum_{i=1}^Dix_i^4+rand[0,1)\end{aligned}$\vspace*{2ex}\\
        Schwefel 2.26 &$\left[-500,\,500\right]^D$   &$\begin{aligned}f_8(x)= &\textstyle\sum_{i=1}^D-x_i\,\sin\sqrt{|x_i|}\,+ \\
                    &\vphantom{\sum}+ D\cdot
                    418.98288727243369 \end{aligned}$\\
        Rastrigin     &$\left[-5.12,\,5.12\right]^D$ &
        $\begin{aligned}\textstyle
          f_9(x)=\sum_{i=1}^D\left[x_i^2-10\,\cos(2\pi
            x_i)+10\right]\end{aligned}$\vspace*{2ex}\\
  Ackley        &$\left[-32,\,32\right]^D$     &$\begin{aligned}f_{10}(x)= &\textstyle -20\, {\rm exp}\!\left(-0.2\sqrt{\frac{1}{D}\sum_{i=1}^Dx_i^2} \right)-\\
                    &\textstyle - {\rm exp}\left(\frac{1}{D}\sum_{i=1}^D\cos(2\pi x_i)  \right)  + 20 + e \end{aligned}$ \\
        Griewank      &$\left[-600,\,600\right]^D$
        &$\begin{aligned}f_{11}(x)= &\textstyle \frac{1}{4000}
          \sum_{i=1}^{D}x_i^2 - \prod_{i=1}^D\cos\left(x_i/\sqrt{i}\right) +1     \end{aligned}$ \vspace*{3ex} \\
        штрафная 1    &$\left[-50,\,50\right]^D$     &
        $\begin{aligned}f_{12}(x)= &\textstyle \frac{\pi}{D}
          \Big\{ 10\,\sin^2(\pi y_1) +\\ &+
          \textstyle \sum_{i=1}^{D-1}(y_i-1)^2\left[1+10\,\sin^2(\pi
              y_{i+1})\right] +\\ &+(y_D-1)^2 \Big\} +\textstyle\sum_{i=1}^D u(x_i,\,10,\,100,\,4)            \end{aligned}$ \vspace*{2ex} \\
        штрафная 2    &$\left[-50,\,50\right]^D$     &
        $\begin{aligned}f_{13}(x)= &\textstyle 0.1
          \Big\{\sin^2(3\pi x_1) +\\ &+
          \textstyle \sum_{i=1}^{D-1}(x_i-1)^2\left[1+\sin^2(3 \pi
              x_{i+1})\right] + \\ &+(x_D-1)^2\left[1+\sin^2(2\pi
              x_D)\right] \Big\} +\\ &+\textstyle\sum_{i=1}^D u(x_i,\,5,\,100,\,4)            \end{aligned}$            \vspace*{1ex}\\
        \midrule%%% тонкий разделитель
        \multicolumn{3}{@{}p{\textwidth}}{%
            \vspace*{-4ex}% этим подтягиваем повыше
            \hspace*{2.5em}% абзацный отступ - требование ГОСТ 2.105
            Примечание "---  Для функций $f_{12}$ и $f_{13}$
            используется $y_i = 1 + \frac{1}{4}(x_i+1)$ и
            $u(x_i,\,a,\,k,\,m)=\begin{cases}
k(x_i-a)^m,\quad &x_i >a\\[-0.5em]
0,\quad &-a\leq x_i \leq a\\[-0.5em]
k(-x_i-a)^m,\quad &x_i <-a
\end{cases}$  }   \\        \bottomrule %%% нижняя линейка 
\end{longtabu} 
\endgroup




\begingroup % Ограничиваем область видимости arraystretch
\renewcommand{\arraystretch}{1.6}%% Увеличение расстояния между рядами, для улучшения восприятия.
\begin{longtabu} to \textwidth {@{}>{\setlength{\baselineskip}{0.7\baselineskip}}X[1.1mc]>{\setlength{\baselineskip}{0.7\baselineskip}}X[mc]X[4]@{}}
        \caption{Сравнение различных алгоритмов оптимизации.\label{tbl:opt-results-book}}\\% label всегда желательно идти после caption 
        
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endfirsthead

        \multicolumn{3}{c}{\small\slshape (продолжение)}        \\ 
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endhead
        
        \multicolumn{3}{c}{\small\slshape (окончание)}        \\ 
        \toprule     %%% верхняя линейка
        Имя           &Стартовый диапазон параметров &Функция  \\ 
        \midrule %%% тонкий разделитель. Отделяет названия столбцов. Обязателен по ГОСТ 2.105 пункт 4.4.5 
        \endlasthead

        \bottomrule %%% нижняя линейка
        \multicolumn{3}{r}{\small\slshape продолжение следует}  \\ 
        \endfoot   
        \endlastfoot

        сфера         &$\left[-100,\,100\right]^D$   &
        $\begin{aligned}\textstyle f_1(x)=\sum_{i=1}^Dx_i^2\end{aligned}$                                                        \\
        Schwefel 2.22 &$\left[-10,\,10\right]^D$     &
        $\begin{aligned}\textstyle f_2(x)=\sum_{i=1}^D|x_i|+\prod_{i=1}^D|x_i|\end{aligned}$                                     \\
        Schwefel 1.2  &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_3(x)=\sum_{i=1}^D\left(\sum_{j=1}^ix_j\right)^2\end{aligned}$                               \\
        Schwefel 2.21 &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_4(x)={\rm max}_i\!\left\{\left|x_i\right|\right\}\end{aligned}$                             \\
        Rosenbrock    &$\left[-30,\,30\right]^D$     &$\begin{aligned}\textstyle f_5(x)=\sum_{i=1}^{D-1}\left[100\!\left(x_{i+1}-x_i^2\right)^2+(x_i-1)^2\right]\end{aligned}$ \\
        ступенчатая   &$\left[-100,\,100\right]^D$   &$\begin{aligned}\textstyle f_6(x)=\sum_{i=1}^D\big\lfloor x_i+0.5\big\rfloor^2\end{aligned}$                             \\ 
зашумлённая квартическая  &$\left[-1.28,\,1.28\right]^D$ &$\begin{aligned}\textstyle f_7(x)=\sum_{i=1}^Dix_i^4+rand[0,1)\end{aligned}$\vspace*{2ex}\\
        Schwefel 2.26 &$\left[-500,\,500\right]^D$   &$\begin{aligned}f_8(x)= &\textstyle\sum_{i=1}^D-x_i\,\sin\sqrt{|x_i|}\,+ \\
                    &\vphantom{\sum}+ D\cdot
                    418.98288727243369 \end{aligned}$\\
        Rastrigin     &$\left[-5.12,\,5.12\right]^D$ &
        $\begin{aligned}\textstyle
          f_9(x)=\sum_{i=1}^D\left[x_i^2-10\,\cos(2\pi
            x_i)+10\right]\end{aligned}$\vspace*{2ex}\\
  Ackley        &$\left[-32,\,32\right]^D$     &$\begin{aligned}f_{10}(x)= &\textstyle -20\, {\rm exp}\!\left(-0.2\sqrt{\frac{1}{D}\sum_{i=1}^Dx_i^2} \right)-\\
                    &\textstyle - {\rm exp}\left(\frac{1}{D}\sum_{i=1}^D\cos(2\pi x_i)  \right)  + 20 + e \end{aligned}$ \\
        Griewank      &$\left[-600,\,600\right]^D$
        &$\begin{aligned}f_{11}(x)= &\textstyle \frac{1}{4000}
          \sum_{i=1}^{D}x_i^2 - \prod_{i=1}^D\cos\left(x_i/\sqrt{i}\right) +1     \end{aligned}$ \vspace*{3ex} \\
        штрафная 1    &$\left[-50,\,50\right]^D$     &
        $\begin{aligned}f_{12}(x)= &\textstyle \frac{\pi}{D}
          \Big\{ 10\,\sin^2(\pi y_1) +\\ &+
          \textstyle \sum_{i=1}^{D-1}(y_i-1)^2\left[1+10\,\sin^2(\pi
              y_{i+1})\right] +\\ &+(y_D-1)^2 \Big\} +\textstyle\sum_{i=1}^D u(x_i,\,10,\,100,\,4)            \end{aligned}$ \vspace*{2ex} \\
        штрафная 2    &$\left[-50,\,50\right]^D$     &
        $\begin{aligned}f_{13}(x)= &\textstyle 0.1
          \Big\{\sin^2(3\pi x_1) +\\ &+
          \textstyle \sum_{i=1}^{D-1}(x_i-1)^2\left[1+\sin^2(3 \pi
              x_{i+1})\right] + \\ &+(x_D-1)^2\left[1+\sin^2(2\pi
              x_D)\right] \Big\} +\\ &+\textstyle\sum_{i=1}^D u(x_i,\,5,\,100,\,4)            \end{aligned}$            \vspace*{1ex}\\
        \midrule%%% тонкий разделитель
        \multicolumn{3}{@{}p{\textwidth}}{%
            \vspace*{-4ex}% этим подтягиваем повыше
            \hspace*{2.5em}% абзацный отступ - требование ГОСТ 2.105
            Примечание "---  Для функций $f_{12}$ и $f_{13}$
            используется $y_i = 1 + \frac{1}{4}(x_i+1)$ и
            $u(x_i,\,a,\,k,\,m)=\begin{cases}
k(x_i-a)^m,\quad &x_i >a\\[-0.5em]
0,\quad &-a\leq x_i \leq a\\[-0.5em]
k(-x_i-a)^m,\quad &x_i <-a
\end{cases}$  }   \\        \bottomrule %%% нижняя линейка 
\end{longtabu} 


 Было получено
свидетельство о государственной регистрации программы для
ЭВМ~№2014611568.
\clearpage