\def\slantfrac#1#2{ \hspace{3pt}\!^{#1}\!\!\hspace{1pt}/
  \hspace{2pt}\!\!_{#2}\!\hspace{3pt}
} %Красивые дроби в строчку (например, 1/2)

% \begin{align*}
% f(x) =& x^2\! +3x\! +2 \\
% f(x) =& x^2+3x+2 \\
% f(x) =& x^2\, +3x\, +2 \\
% f(x) =& x^2\: +3x\: +2 \\
% f(x) =& x^2\; +3x\; +2 \\
% f(x) =& x^2\ +3x\ +2 \\
% f(x) =& x^2\quad +3x\quad +2 \\
% f(x) =& x^2\qquad +3x\qquad +2
% \end{align*}

\chapter{Модификация теории Ми для случая многослойной сферы} \label{chapt1}
\section{Современные методы моделирования уравнений Максвелла}
\label{sec:em-methods-intro}
При рассмотрении вопроса о рассеянии и поглощении электромагнитных
волн многослойными сферическими наночастицами в первую очередь
возникает проблема выбора математичой модели, которая описывала бы
такую систему.  В настоящее время существует огромное число методов
компьютерного моделирования явлений электромагнетизма достаточно
общего
вида~\cite{Yu-PFDTD-2006,Inan-FDTD-2011,clemson,Bondenson-CEM-2005,Yu-Advanced-FDTD-2011}:
\begin{itemize}
\item метод конечных элементов (МКЭ, finite element method, FEM)
\item метод конечных объёмов во временной области (finite volume
  time-domain, FVTD)
\item метод моментов (method of moments, MoM), как правило реализуемый
  в рамках метода граничных элементов (boundary element method, BEM)
\item метод конечных интегралов (finite integration technique, FIT)
\item метод конечных разностей в временной области (finite difference
  time domain, FDTD)
\item метод конечных разностей в частотной области (finite difference
  frequency domain, FDFD)
\item псевдоспектральный метод во временной области (pseudospectral
  time domain method, PSTD)
\item метод матриц линий передач (transmission line matrix method,
  TLM)
\item приближение дискретиных диполей (discrete dipole approximation, DDA)
\end{itemize}
Здесь не упоминаются модификации и усовершенствования этих методов
(иногда существенным образом меняющие исходный алгоритм), как и не
упоминается большое число других методов.  В целом, каждый из методов
можно пытаться классифицировать по следующим параметрам: метод основан
на интегральной или дифференциальной форме уравнений Максвелла, метод
оперирует данными во временной или в частотной области, дискретизации
подвергается вся модель или только границы её составных объёмов и т.д.

Сравнение этих методов приводится во многих источниках.
В~\cite{Inan-FDTD-2011} перечисляются такие достоинства метода FDTD
как малое время разработки работоспособной программы, простота метода
для понимания и то, что метод работает с уравнениями Максвелла в явном
виде, не привлекая приёмы линейной алгебры, а также его недостатки:
ступенчатая аппроксимация и большая вычислительная сложность.  При
сравнении с методом FVTD отмечается, что последний лучше подходит для
неоднородных объектов, время моделирования сопоставимо с временем
метода FDTD, а основным недостатком является необходимость
дискретизации объёма модели неоднородной сеткой (что в общем случае
является нетривиальной задачей).  Сильные стороны метода FDFD
демонстрируются в случае, когда необходимо получить установившееся
решение для одной частоты.  Особо ярко это проявляется для материалов,
чья зависимость от частоты не может быть формализована простыми
моделями для метода FDTD.  Достоинства FEM аналогичны достоинствам
метода FVTD, а основной недостаток состоит в том, что необходимо
решать всю систему уравнений (она может быть очень большой) для всего
объекта моделирования сразу.  PSTD, относящийся к спектральным
методам, характеризуется тем, что использует разложение (чаще всего
Фурье) полей общего решения модели.  При этом используется значительно
менее плотная сетка дискретизации, что даёт существенный выигрыш в
задействованных памяти и вычислительных ресурсах компьютера.

В книге~\cite{Bondenson-CEM-2005} для выбранного пространственного
размера задачи (3D) приводится вычислительная сложность разных методов
в зависимости от частоты $f$ изучаемого электромагнитного поля.  Для
FDTD число операций растёт как $O(f^4)$, основной недостаток ---
ступенчатая аппроксимация границ, проходящих под углом к направлениям
прямоугольной сетки дискретизации.  FVTD хорошо справляется со
сложными геометриями объектов модели, имеет ту же сложность, что и
FDTD, но обладает слабой <<отложенной>> нестабильностью.
Вычислительная сложность FEM растёт как $O(f^4)$ и для частотной, и
для временной области, он более стабилен, чем FVTD.  Для регулярной 3D
сетки дискретизации TLM может быть представлен в форме, эквивалентной
FDTD.  FIT обладает вычислительной сложностью FDTD, но позволяет
использовать произвольные сетки дискретизации с сохранением
стабильности.  Вычислительная сложность MoM зависит от выбранного
метода решения системы уравнений.  Для fast multipole method (FMM) это
$O(f^3)$, а для multilevel fast multipole algorithm (MLFMA) это
$O(f^2\log f)$.

В книге~\cite{Yu-Advanced-FDTD-2011} на одной и той же аппаратной
платформе производилось моделирование общего набора задач с помощью
коммерчески доступных пакетов, основанных на разных
(указанных в скобках) методах: HFSS (FEM), CST (FIT), GEMS (FDTD),
FEKO (MoM). Сравнение результатов расчётов даёт довольно хорошее
совпадение для CST и GEMS, которые оказались способны решить весь
набор тестовых задач. GEMS оказался быстрее (иногда в несколько раз)
CST и использовал меньшее количество оперативной памяти.

Объектом изучения настоящей работы является сферическая наночастица,
что позволяет применять для расчётов специализированные методы. Прежде
всего, это теория Ми для многослойной сферы~\cite{Yang-2003} и её
развитие в виде метода Т-матриц для множества сфер (Multiple Sphere
T-Matrix)~\cite{MacKowski-2012}.  По сравнению с более общими методами
применение этой теории позволяет значительно сократить объём
вычислений, необходимый, например, для расчёта сечения рассеяния и
сечения поглощения.  Дополнительным преимуществом теории Ми является
возможность разделять вклады электрических и магнитных мультполей в
общий электромагнитный отклик частицы.


\section{Теория Ми для многослойной сферы: расчёт ближнего поля}
\label{sec:Mie}

Более 100 лет назад Густав Ми опубликовал свою оригинальную
работу~\cite{Mie-1908} о взаимодействии плоской электромагнитной волны
с однородной сферой.  Изложенная в ней теория впоследствии получила
его имя и в настоящее время входит в число основных инструментов,
применяемых при анализе задач рассеяния и поглощения сферическими
объектами.  Несмотря на более чем вековую историю теории Ми, работы по
её дальнейшему развитию ведутся и в настоящее время~\cite{Suzuki-2008,
  MacKowski-2012, Lerme-2000, Xu-2005, Li-2006, Gogoi-2010,
  Santiago-2011}.  Довольно часто авторы таких работ предоставляют
доступ к программам, реализующих их наработки в этой области, что
позволяет напрямую сравнивать их между собой.  К сожалению, большая
часть таких программ относится к случаю сферы с одним слоем покрытия
или небольшим числом слоёв. Тем не менее, рядом авторов были
предложены математические модели~\cite{Yang-2003,
  Pena-scattnlay-2009}, позволяющие изучать многослойные сферы с
произвольным числом слоёв~\cite{Sheehan-2013,Selmke-2012}.  Основная
сложность при этом связана с численной реализацией этих моделей.

Рассмотрим рассеяние плоской волны, поляризованной вдоль
координаты~$x$, следуя классическому подходу, изложенному в книге
К.Ф.~Бохрена и Д.Р.~Хаффмана~\cite{Bohren-1983}.  В сферических
координатах такую волну можно записать как:
\begin{equation*}
  \label{eq:bh4.21}
  {\rm \mathbf{E}}_i = E_0 e^{i{\rm k}r{\rm cos}\theta}
  {\rm \mathbf{\^e}}_{x}\:, 
\end{equation*}
\begin{equation*}
{\rm \mathbf{\^e}}_{x} = \,{\rm sin}\theta\, {\rm cos} \phi\, {\rm
  \mathbf{ \^e}}_{r} 
+\, {\rm cos}\theta\, {\rm sin} \phi\, {\rm
  \mathbf{ \^e}}_{\theta}
-\, {\rm sin} \phi\, {\rm  \mathbf{ \^e}}_{\phi}\:,
\end{equation*}
где $E_0$ амплитуда падающего поля, а $r,\theta,\phi$ и
${\rm \mathbf{ \^e}}$ - полярные координаты и единичный вектор для
выбранной системы координат, $k$ волновой вектор падающей волны.
Тогда решение для рассеянного поля выражается в виде разложения в ряд:
\begin{align*}
{\rm \mathbf{E}}_s &=\sum_{n=1}^{\infty} E_n \left( i a_n {\rm
    \mathbf{N}}_{e1n}^{(3)} - b_n{\rm\mathbf{M}_{o1n}^{(3)}} \right)\:,\\
{\rm \mathbf{H}}_s &=\frac{k}{\omega\mu}
 \sum_{n=1}^{\infty} E_n \left( i b_n {\rm
    \mathbf{N}}_{o1n}^{(3)} + a_n{\rm\mathbf{M}_{e1n}^{(3)}} \right)\:,  
\end{align*}
где $E_n=i^nE_0(2n+1)/n(n+1)$, $n$ порядок мультиполя, $E_0$ амплитуда
падающего поля, $a_n$ и $b_n$ коэффициенты разложения, соответствующие
электрическим и магнитным мультиполям, ${\rm \mathbf{N}}_{e1n}^{(3)}$,
${\rm \mathbf{N}}_{o1n}^{(3)}$, ${\rm\mathbf{M}_{o1n}^{(3)}}$ и
${\rm\mathbf{M}_{e1n}^{(3)}}$ это сферические векторные гармоники,
выражающиеся через тригонометрические функции, полиномы Лежандра и
сферические функции Бесселя и Ханкеля, $\omega$ частота падающей
волны, $\mu$ магнитная проницаемость в вакууме.  Аналогичным образом
может быть выражено поле внутри $l$-ого слоя стратифицированной
сферы~\cite{Yang-2003}:
\begin{align}
{\rm \mathbf{E}}_l &=\sum_{n=1}^{\infty} E_n \left(
                     c_n^{(l)}{\rm\mathbf{M}}_{o1n}^{(1)}
                     -i d_n^{(l)} {\rm \mathbf{N}}_{e1n}^{(1)}
                     +i a_n^{(l)} {\rm \mathbf{N}}_{e1n}^{(3)}
                     - b_n^{(l)}{\rm\mathbf{M}}_{o1n}^{(3)} 
                     \right)\label{eq:3p1}\:,\\
{\rm \mathbf{H}}_l &=\frac{k_l}{\omega\mu} \sum_{n=1}^{\infty} E_n
                     \left(
                      d_n^{(l)}{\rm\mathbf{M}}_{e1n}^{(1)} 
                     +i c_n^{(l)} {\rm \mathbf{N}}_{o1n}^{(1)} 
                     -i b_n^{(l)} {\rm \mathbf{N}}_{o1n}^{(3)} 
                     - a_n^{(l)}{\rm\mathbf{M}}_{e1n}^{(3)} 
                     \right)\:,\label{eq:3p2}  
\end{align}
где для каждого слоя определены коэффициенты разложения $d_n^{(l)}$ и
$c_n^{(l)}$ электрического и магнитного поля для входящей волны
(направленной к центру частицы) и, аналогично, $a_n^{(l)}$ и
$b_n^{(l)}$ для исходящей волны.  Связь между всеми коэффициентами
разложения можно выразить в виде системы рекуррентных уравнений,
которые получаются из граничных условий на непрерывность
нормальных компонент полей между слоями~\cite{Yang-2003}:

\begin{equation} % \tag{S} % tag - вписывает свой текст
  \label{eq:A2d1}
    % \begin{multlined}
    \begin{alignedat}{2}
d^{(l+1)}_{n}m_{l} \psi^{\prime}_{n}&{\left (m_{l+1} x_{l} \right )}
- a^{(l+1)}_{n} m_{l} \zeta^{\prime}_{n}{\left (m_{l+1} x_{l} \right )}-\\
& - d^{(l)}_{n} m_{l+1} \psi^{\prime}_{n}{\left (m_{l} x_{l} \right )} 
+ a^{(l)}_{n} m_{l+1} \zeta^{\prime}_{n}{\left (m_{l} x_{l} \right )}
= 0\:,
\end{alignedat}
\end{equation}
\begin{equation} % \tag{S} % tag - вписывает свой текст
  \label{eq:A2d2}
\begin{alignedat}{2}
c^{(l+1)}_{n} m_{l} \psi_{n}&{\left (m_{l+1} x_{l} \right )}
  - b^{(l+1)}_{n} m_{l} \zeta_{n}{\left (m_{l+1} x_{l} \right )}-\\
&- c^{(l)}_{n} m_{l+1} \psi_{n}{\left (m_{l} x_{l} \right )} 
+b^{(l)}_{n} m_{l+1} \zeta_{n}{\left (m_{l} x_{l} \right )}  =0\:,
\end{alignedat}
\end{equation}
\begin{equation} % \tag{S} % tag - вписывает свой текст
  \label{eq:A2d3}
\begin{alignedat}{2}
c^{(l+1)}_{n} \psi^{\prime}_{n}&{\left (m_{l+1} x_{l} \right )}
- b^{(l+1)}_{n} \zeta^{\prime}_{n}{\left (m_{l+1} x_{l} \right )}-\\
&- c^{(l)}_{n} \psi^{\prime}_{n}{\left (m_{l} x_{l} \right )} 
+b^{(l)}_{n} \zeta^{\prime}_{n}{\left (m_{l} x_{l} \right )}   =0\:,
\end{alignedat}
\end{equation}
\begin{equation} % \tag{S} % tag - вписывает свой текст
  \label{eq:A2d4}
\begin{alignedat}{2}
 d^{(l+1)}_{n} \psi_{n}&{\left (m_{l+1} x_{l} \right )}
- a^{(l+1)}_{n} \zeta_{n}{\left (m_{l+1} x_{l} \right )}-\\
& - d^{(l)}_{n} \psi_{n}{\left (m_{l} x_{l} \right )} 
+ a^{(l)}_{n} \zeta_{n}{\left (m_{l} x_{l} \right )}   =0\:,
\end{alignedat}
% \end{multlined}
\end{equation}
где $m_l$ показатель преломления в слое, нормированный на показатель
преломления окружающего пространства, $x_l$ параметр размера внешнего
радиуса слоя, $\psi_{n}(z) = z j_n(z)$ и $\zeta_{n}(z) = z h_n^1(z)$
функции Риккати-Бесселя, выраженные через сферические функции Бесселя
и Ханкеля.  Из выражений для падающей и рассеянной волны получаются
дополнительные условия на коэффициенты разложения
$c_n^{(L+1)}=d_n^{(L+1)}=1$, $a_n=a_n^{(L+1)}$ и $b_n=b_n^{(L+1)}$,
где $L$ общее число слоёв. Так как у центрального слоя $l=1$ нет
внутренней границы, то $a_n^{(1)}=b_n^{(1)}=0$. Последнее условие
является избыточным для системы
уравнений~(\labelcref{eq:A2d1,eq:A2d2,eq:A2d3,eq:A2d4}), и поэтому оно
было использовано для дополнительной проверки самосогласованности
работы компьютерной программы.  После проведения необходимых
алгебраических преобразований были получены значения коэффициентов
разложения в виде обратной рекуррентной последовательности:
\begin{equation}
\label{eq:6p1}
a^{(l)}_n = \frac
{
    {D^{(1)}_{n}}{\left (m_{l} x_{l} \right )}
    T_1\left (m_{l+1} x_{l} \right )
    +
    T_3\left (m_{l+1} x_{l} \right )
    m_{l}/m_{l+1}
}
{
   \zeta_{n}\left (m_{l} x_{l} \right )
   U\left (m_{l} x_{l} \right )
}\:,
\end{equation}
\begin{equation}
\label{eq:6p2}
b^{(l)}_n = \frac
{
    {D^{(1)}_{n}}{\left (m_{l} x_{l} \right )}
    T_2\left (m_{l+1} x_{l} \right )
    m_{l}/m_{l+1}
    +
    T_4\left (m_{l+1} x_{l} \right )
}
{
   \zeta_{n}\left (m_{l} x_{l} \right )
   U\left (m_{l} x_{l} \right )
}\:,
\end{equation}
\begin{equation}
\label{eq:6p3}
c^{(l)}_n = \frac
{
    {D^{(3)}_{n}}{\left (m_{l} x_{l} \right )}
    T_2\left (m_{l+1} x_{l} \right )
    m_{l}/m_{l+1}
    +
    T_4\left (m_{l+1} x_{l} \right )
}
{
   \psi_{n}\left (m_{l} x_{l} \right )
   U\left (m_{l} x_{l} \right )
}\:,
\end{equation}
\begin{equation}
\label{eq:6p4}
d^{(l)}_n = \frac
{
    {D^{(3)}_{n}}{\left (m_{l} x_{l} \right )}
    T_1\left (m_{l+1} x_{l} \right )
    +
    T_3\left (m_{l+1} x_{l} \right )
    m_{l}/m_{l+1}
}
{
   \psi_{n}\left (m_{l} x_{l} \right )
   U\left (m_{l} x_{l} \right )
}\:,
\end{equation}
используя
\begin{equation*}
  U(z) =    {D^{(1)}_{n}}(z) - {D^{(3)}_{n}}(z)\:,
\end{equation*}
\begin{equation*}
  T_1(z) =   a^{(l+1)}_{n}  \zeta_{n}(z) 
           - d^{(l+1)}_{n}  \psi_{n}(z)\:,
\end{equation*}
\begin{equation*}
  T_2(z) =   b^{(l+1)}_{n}  \zeta_{n}(z) 
           - c^{(l+1)}_{n}  \psi_{n}(z)\:,
\end{equation*}
\begin{equation*}
  T_3(z) =  d^{(l+1)}_{n}  D^{(1)}_{n}(z)  \psi_{n}(z) 
          - a^{(l+1)}_{n}  D^{(3)}_{n}(z)  \zeta_{n} (z)\:,
\end{equation*}
\begin{equation*}
  T_4(z) =  b^{(l+1)}_{n}  D^{(1)}_{n}(z)  \psi_{n}(z) 
          - c^{(l+1)}_{n}  D^{(3)}_{n}(z)  \zeta_{n} (z)\:,
\end{equation*}
где $m_l = n_{\rm layer}/n_{\rm host}$ комплексный показатель
преломления в слое, нормированный на показатель преломления
окружающего пространства, $x_l$ параметр размера внешнего радиуса
слоя, $\psi_{n}(z) = z j_n(z)$ и $\zeta_{n}(z) = z h_n^1(z)$ функции
Риккати-Бесселя, выраженные через сферические функции Бесселя и
Ханкеля, $D^{(1)}_{n} = \psi^{\prime}_{n}/\psi_{n}$ и
$D^{(3)}_{n} = \zeta^{\prime}_{n}/\zeta_{n}$ это логарифмические
производные функций Риккати-Бесселя. Подставляя
(\labelcref{eq:6p1,eq:6p2,eq:6p3,eq:6p4}) в уравнения (\ref{eq:3p1}) и
(\ref{eq:3p2}), можно вычислить величину электрического и магнитного
поля внутри и снаружи многослойной сферы.

Решение системы
уравнений~(\labelcref{eq:A2d1,eq:A2d2,eq:A2d3,eq:A2d4}) может быть
выраженно и в виде прямой рекуррентной зависимости. Такое решение было
получено, однако
TODO возможно решение в виде прямой рекуррентной зависимости

При этом возникает дополнительная сложность, связанная с вычислением
сферических векторных гармоник, выражаемых через сферические функции
Бесселя ($j=1$) и Ханкеля ($j=3$) первого рода $z_n^{(j)}$:
\begin{equation}
  \label{eq:2p1}
 \begin{alignedat}{2}
  {\rm\mathbf{M}}_{o1n}^{(j)} ={\rm cos} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         z_n^{(j)}\!\left( \rho \right)\,
         {\rm \mathbf{ \^e}}_{\theta}   
-\,{\rm sin} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         z_n^{(j)}\!\left( \rho \right)\,
         &{\rm \mathbf{ \^e}}_{\phi}\:,
 \end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p2}
 \begin{alignedat}{2}
  {\rm\mathbf{M}}_{e1n}^{(j)} =-\,{\rm sin} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         z_n^{(j)}\!\left( \rho \right)\,
         {\rm \mathbf{ \^e}}_{\theta}   
-\, {\rm cos} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         z_n^{(j)}\!\left( \rho \right)\,
         &{\rm \mathbf{ \^e}}_{\phi}\:,
 \end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p3}
 \begin{alignedat}{2}
{\rm \mathbf{N}}_{o1n}^{(j)} = \,{\rm sin} \phi\,n\!\left(n+1\right)
         {\rm sin}\theta\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
               z_n^{(j)}\!\left( \rho \right)
              }{\rho}\,
           &{\rm \mathbf{ \^e}}_{r}   \\
+\,
{\rm sin} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{
            \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\theta}   \\
+\,
{\rm cos} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
            \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\phi}\:,
\end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p4}
 \begin{alignedat}{2}
{\rm \mathbf{N}}_{e1n}^{(j)} = \,{\rm cos} \phi\,n\!\left(n+1\right)
         {\rm sin}\theta\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
               z_n^{(j)}\!\left( \rho \right)
              }{\rho}\,
           &{\rm \mathbf{ \^e}}_{r}   \\
+\,
{\rm cos} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{
            \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\theta}   \\
+\,
{\rm sin} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
            \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\phi}\:,
\end{alignedat}
\end{equation}
где обезразмеренное расстояние до центра сферы $\rho=kr$, а угловые
функции
\begin{equation*}
  \label{eq:bh4.46}
  \pi_n=\frac{P_n^1}{{\rm cos}\theta} \qquad \mbox{и} \qquad \tau_n = \frac{dP_n^1}{d\theta}
\end{equation*}
выражены через функцию Лежандра $P_n^m$, которая
задаётся через производную полинома Лежандра $P_n$ в виде:
\begin{equation*}
  \label{eq:bh4.25}
  P_n^m\left(\mu\right)=\left(1-\mu^2\right)^{m/2}\frac{d^{\,m}P_n(\mu)}{d\mu^m}\:,
\end{equation*}
где $\mu = {\rm cos}\theta$. Чтобы расчитать значения угловых функций
необходимо воспользоваться рекуррентными
соотношениями~\cite{Wiscombe-1980}
\begin{equation*}
  \label{eq:bh4.47}
  \pi_0 = 0, \qquad \pi_1 = 1, \qquad
  \pi_n = \frac{2n-1}{n-1}{\rm cos}\theta\,\pi_{n-1} - \frac{n}{n-1}\pi_{n-2}\:,
\end{equation*}
\begin{equation*}
  \tau_n = n{\rm cos}\theta\,\pi_{n} + (n+1)\pi_{n-1}\:,
\end{equation*}
доказавшими свою численную устойчивость.  Таким образом, основную
сложность при вычислении значений сферических векторных гармоник
представляет суммирование рядов, выражающих сферические функции
Бесселя.  Плохая сходимость таких рядов особенно заметна в случае
комплексного аргумента с большой мнимой частью.  Для решения этой
проблемы в настоящей работе был предложен следующий вид сферических
векторных гармоник:
\begin{equation}
  \label{eq:2p1}
 \begin{alignedat}{2}
  {\rm\mathbf{M}}_{o1n}^{(j)} ={\rm cos} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{r_n^{(j)}\!\left( \rho \right)}{\rho}\,
         {\rm \mathbf{ \^e}}_{\theta}   
-\,{\rm sin} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{r_n^{(j)}\!\left( \rho \right)}{\rho}\,
         &{\rm \mathbf{ \^e}}_{\phi}\:,
 \end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p2}
 \begin{alignedat}{2}
  {\rm\mathbf{M}}_{e1n}^{(j)} =-\,{\rm sin} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{r_n^{(j)}\!\left( \rho \right)}{\rho}\,
         {\rm \mathbf{ \^e}}_{\theta}   
-\, {\rm cos} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{r_n^{(j)}\!\left( \rho \right)}{\rho}\,
         &{\rm \mathbf{ \^e}}_{\phi}\:,
 \end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p3}
 \begin{alignedat}{2}
{\rm \mathbf{N}}_{o1n}^{(j)} = \,{\rm sin} \phi\,n\!\left(n+1\right)
         {\rm sin}\theta\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
           r_n^{(j)}\!\left( \rho \right)
              }{\rho^2}\,
           &{\rm \mathbf{ \^e}}_{r}   \\
+\,
{\rm sin} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{
           D_n^{(j)}\!(\rho) r_n^{(j)}\!(\rho)
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\theta}   \\
+\,
{\rm cos} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
           D_n^{(j)}\!(\rho) r_n^{(j)}\!(\rho)
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\phi}\:,
\end{alignedat}
\end{equation}
%
\begin{equation}
  %\label{eq:2p4}
 \begin{alignedat}{2}
{\rm \mathbf{N}}_{e1n}^{(j)} = \,{\rm cos} \phi\,n\!\left(n+1\right)
         {\rm sin}\theta\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
               r_n^{(j)}\!\left( \rho^2 \right)
              }{\rho}\,
           &{\rm \mathbf{ \^e}}_{r}   \\
+\,
{\rm cos} \phi\,
         \tau_n\!\left({\rm  cos} \theta\right)
         \frac{
           D_n^{(j)}\!(\rho) r_n^{(j)}\!(\rho)
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\theta}   \\
+\,
{\rm sin} \phi\,
         \pi_n\!\left({\rm  cos} \theta\right)
         \frac{
           D_n^{(j)}\!(\rho) r_n^{(j)}\!(\rho)
              }{\rho}\,
            &{\rm \mathbf{ \^e}}_{\phi}\:,
\end{alignedat}
\end{equation}
где используются функции Риккати-Бесселя $r_n^{(1)} = \psi_n$ и
$r_n^{(3)} = \zeta_n$ и их логарифмические производные, они, в свою
очередь, могут быть выражены в виде рекуррентных соотношений с хорошей
сходимостью для более широкого диапазона
агрументов~\cite{Wiscombe-1980,Mackowski-1990}, благодаря чему в
настоящей работе удалось заметно увеличить численную устойчивость
расчёта по теории Ми.


Полученные выражения позволили полностью переработать
программу~\cite{Scattnlay-web} для проведения расчёта.  В результате
программа получила возможность расчёта полей, доработка уже
существовавших алгоритмических решений позволила сократить время
вычислений в 2.2 раза.

\section{Компьютерная реализация алгоритма расчёта по теории Ми.}
\label{sec:code}


% Ссылки на собственные работы:~\cite{vakbib1, confbib1}
% Сошлёмся на приложения: Приложение \ref{AppendixA}, Приложение \ref{AppendixB2}.
% Сошлёмся на формулу: формула \eqref{eq:equation1}.
% Сошлёмся на изображение: рисунок \ref{img:knuth}.

% Используя команду \verb|\labelcref| из пакета \verb|cleveref|, можно
% красиво ссылаться сразу на несколько формул
% (\labelcref{eq:equation1,eq:equation3,eq:equation2}), даже перепутав
% порядок ссылок \verb|(\labelcref{eq:equation1,eq:equation3,eq:equation2})|.
